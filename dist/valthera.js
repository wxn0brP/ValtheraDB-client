class T{db;collection;constructor(f,$){this.db=f,this.collection=$}add(f,$){return this.db.add({collection:this.collection,data:f,id_gen:$})}find(f={},$={},S={},E={}){return this.db.find({collection:this.collection,search:f,dbFindOpts:$,findOpts:S,context:E})}findOne(f={},$={},S={}){return this.db.findOne({collection:this.collection,search:f,findOpts:$,context:S})}update(f,$,S={}){return this.db.update({collection:this.collection,search:f,updater:$,context:S})}updateOne(f,$,S={}){return this.db.updateOne({collection:this.collection,search:f,updater:$,context:S})}remove(f,$={}){return this.db.remove({collection:this.collection,search:f,context:$})}removeOne(f,$={}){return this.db.removeOne({collection:this.collection,search:f,context:$})}updateOneOrAdd(f,$,{add_arg:S={},context:E={},id_gen:A=!0}={}){return this.db.updateOneOrAdd({collection:this.collection,search:f,updater:$,add_arg:S,context:E,id_gen:A})}toggleOne(f,$={},S={}){return this.db.toggleOne({collection:this.collection,search:f,data:$,context:S})}}function I(f){let $=[];function S(A){return typeof A==="function"?A.toString():A}function E(A,F=""){Object.keys(A).forEach((K)=>{let z=A[K],P=F?`${F}.${K.replace(/\./g,"[dot]")}`:K;if(typeof z==="function")$.push(P),A[K]=S(z);else if(Array.isArray(z))z.forEach((v,B)=>{if(typeof v==="function")$.push(`${P}[${B}]`),z[B]=S(v)});else if(typeof z==="object"&&z!==null)E(z,P)})}return E(f),{data:f,keys:$}}var D=I;var G="0.0.1";class H{remote;version=G;constructor(f){if(typeof f==="string"){let $=new URL(f),S=$.username,E=$.password;if(!S||!E)throw Error("Invalid remote database");$.username="",$.password="";let A=$.toString().slice(0,-1);this.remote={name:S,url:A,auth:E}}else this.remote=f;if(this.remote.url.endsWith("/"))this.remote.url=this.remote.url.slice(0,-1)}async _request(f,$=[]){let S=D($),E={db:this.remote.name,params:S.data,keys:S.keys},A=this.remote.url+"/db/"+f,F=await fetch(A,{method:"POST",headers:{"Content-Type":"application/json",Authorization:this.remote.auth},body:JSON.stringify(E)}).then((K)=>K.json());if(F.err)throw Error(F.msg);return F.result}c(f){return new T(this,f)}getCollections(){return this._request("getCollections",[])}ensureCollection(f){return this._request("ensureCollection",[f])}issetCollection(f){return this._request("issetCollection",[f])}add(f){return this._request("add",[f])}find(f){return this._request("find",[f])}findOne(f){return this._request("findOne",[f])}update(f){return this._request("update",[f])}updateOne(f){return this._request("updateOne",[f])}remove(f){return this._request("remove",[f])}removeOne(f){return this._request("removeOne",[f])}updateOneOrAdd(f){return this._request("updateOneOrAdd",[f])}toggleOne(f){return this._request("toggleOne",[f])}removeCollection(f){return this._request("removeCollection",[f])}}var Y=H;export{Y as default,H as ValtheraRemote};

//# debugId=3C522DC8BFFA19CB64756E2164756E21
//# sourceMappingURL=valthera.js.map
