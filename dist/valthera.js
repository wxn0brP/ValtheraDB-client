class B{db;collection;constructor($,S){this.db=$,this.collection=S}add($,S){return this.db.add({collection:this.collection,data:$,id_gen:S})}find($={},S={},A={},f={}){return this.db.find({collection:this.collection,search:$,dbFindOpts:S,findOpts:A,context:f})}findOne($={},S={},A={}){return this.db.findOne({collection:this.collection,search:$,findOpts:S,context:A})}update($,S,A={}){return this.db.update({collection:this.collection,search:$,updater:S,context:A})}updateOne($,S,A={}){return this.db.updateOne({collection:this.collection,search:$,updater:S,context:A})}remove($,S={}){return this.db.remove({collection:this.collection,search:$,context:S})}removeOne($,S={}){return this.db.removeOne({collection:this.collection,search:$,context:S})}updateOneOrAdd($,S,{add_arg:A={},context:f={},id_gen:E=!0}={}){return this.db.updateOneOrAdd({collection:this.collection,search:$,updater:S,add_arg:A,context:f,id_gen:E})}toggleOne($,S={},A={}){return this.db.toggleOne({collection:this.collection,search:$,data:S,context:A})}}function H($){let S=[];function A(E){return typeof E==="function"?E.toString():E}function f(E,F=""){Object.keys(E).forEach((K)=>{let z=E[K],P=F?`${F}.${K.replace(/\./g,"[dot]")}`:K;if(typeof z==="function")S.push(P),E[K]=A(z);else if(Array.isArray(z))z.forEach((D,G)=>{if(typeof D==="function")S.push(`${P}[${G}]`),z[G]=A(D)});else if(typeof z==="object"&&z!==null)f(z,P)})}return f($),{data:$,keys:S}}var I="0.0.1";class J{remote;version=I;constructor($){if(typeof $==="string"){let S=new URL($),A=S.username,f=S.password;if(!A||!f)throw Error("Invalid remote database");S.username="",S.password="";let E=S.toString().slice(0,-1);this.remote={name:A,url:E,auth:f}}else this.remote=$;if(this.remote.url.endsWith("/"))this.remote.url=this.remote.url.slice(0,-1)}async _request($,S=[]){let A=H(S),f={db:this.remote.name,params:A.data,keys:A.keys},E=this.remote.url+"/db/"+$,F=await fetch(E,{method:"POST",headers:{"Content-Type":"application/json",Authorization:this.remote.auth},body:JSON.stringify(f)}).then((K)=>K.json());if(F.err)throw Error(F.msg);return F.result}c($){return new B(this,$)}getCollections(){return this._request("getCollections",[])}ensureCollection($){return this._request("ensureCollection",[$])}issetCollection($){return this._request("issetCollection",[$])}add($){return this._request("add",[$])}find($){return this._request("find",[$])}findOne($){return this._request("findOne",[$])}update($){return this._request("update",[$])}updateOne($){return this._request("updateOne",[$])}remove($){return this._request("remove",[$])}removeOne($){return this._request("removeOne",[$])}updateOneOrAdd($){return this._request("updateOneOrAdd",[$])}toggleOne($){return this._request("toggleOne",[$])}removeCollection($){return this._request("removeCollection",[$])}}export{J as ValtheraRemote};

//# debugId=5DC390F6958375FA64756E2164756E21
//# sourceMappingURL=valthera.js.map
